#!/bin/bash
# path to unpack source into


##############################################################################
##### SOFTWARE SOURCES ######################################################
##############################################################################
SHINYFILE=shiny-server-1.5.14.948-amd64.deb
SHINYURL=https://download3.rstudio.org/ubuntu-14.04/x86_64
##############################################################################
##############################################################################
##############################################################################


##############################################################################
##### Dependencies ###########################################################
##############################################################################
apt install -y \
  software-properties-common \
  build-essential
##############################################################################
##############################################################################
##############################################################################


##############################################################################
##### INSTALL R ##############################################################
##############################################################################
# add keys
apt-key adv --keyserver \
  keyserver.ubuntu.com --recv-keys \
  E298A3A825C0D65DFD57CBB651716619E084DAB9

add-apt-repository \
  'deb https://cloud.r-project.org/bin/linux/ubuntu bionic-cran40/'
  
apt update

apt install -y \
  r-base
##############################################################################
##############################################################################
##############################################################################


##############################################################################
####  INSTALL R PACKAGES FIRST ###############################################
##############################################################################
sudo su - \
-c "R -e \"install.packages(c('shiny','rmarkdown'), repos='https://cran.rstudio.com/')\""
##############################################################################
##############################################################################
##############################################################################


##############################################################################
####  INSTALL SHINY-SERVER  ##################################################
##############################################################################
### install Shiny-Server
cd -- "$SRCPATH"
apt install -y gdebi-core
wget "$SHINYURL/$SHINYFILE"
gdebi -n $SHINYFILE
##############################################################################
##############################################################################
##############################################################################


